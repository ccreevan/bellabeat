---
title: "From Fitbit to Bellabeat"
author: "Chris Creevan"
date: "2022-11-07"
output: prettydoc::html_pretty
theme: hpstr
---
# Fitness device insights for Bellabeat marketing

Third-party devices such as a Fitbit can give insights to help market to customers by extrapolating and applying publicly available data. We'll explore three topics:

* Trends in Fitbit usage

* Applying trends to existing Bellabeat customers, and

* Applying trends to market to new customers.

## Data Sources

Publicly available data was downloaded from two ZIP containers of CSV files from [Zenodo](https://zenodo.org/record/53894#.X9oeh3Uzaao):

> These datasets were generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016. Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring.

## Validation & Cleaning

Data is comprised of long-format CSV files. Glimpsing into each CSV file shows clean, reliable data with the same data columns and types in the "overview" sheets, allowing a painless merge. Weight and sleep activity data contained missing information but were merged as well to have a more complete data set.

```{r Datasets, message=FALSE, warning=FALSE, results='hide'}
# load libraries
library(tidyverse)
library(lubridate)

# themes
td <- theme_dark(base_size=20)
tg <- theme_gray(base_size=20)

# load data, be sure folders are in current working directory
# overall
mar <- read_csv("Fitabase Data 3.12.16-4.11.16/dailyActivity_merged.csv")
apr <- read_csv("Fitabase Data 4.12.16-5.12.16/dailyActivity_merged.csv")
# weights
weight1 <- read_csv("Fitabase Data 3.12.16-4.11.16/weightLogInfo_merged.csv")
weight2 <- read_csv("Fitabase Data 4.12.16-5.12.16/weightLogInfo_merged.csv")
# sleep
sleep1 <- read_csv("Fitabase Data 3.12.16-4.11.16/minuteSleep_merged.csv")
sleep2 <- read_csv("Fitabase Data 4.12.16-5.12.16/minuteSleep_merged.csv")
# time in bed
bed <- read_csv("Fitabase Data 4.12.16-5.12.16/sleepDay_merged.csv")
# heart rate
heart1 <- read_csv("Fitabase Data 3.12.16-4.11.16/heartrate_seconds_merged.csv")
heart2 <- read_csv("Fitabase Data 4.12.16-5.12.16/heartrate_seconds_merged.csv")

# merge data frames, change date from string to date type, validates dates, and sorts by user ID and date
totals <- list(mar, apr) %>% 
  reduce(full_join) %>%  
  arrange(Id,ActivityDate) %>% 
  mutate(ActivityDate = mdy(ActivityDate))
weights <- list(weight1, weight2) %>% 
  reduce(full_join) %>% 
  select(Id,Date,WeightPounds,Fat,BMI) %>% 
  arrange(Id,Date) %>% 
  mutate(Date = mdy_hms(Date))
sleeping <- list(sleep1, sleep2) %>% 
  reduce(full_join) %>% 
  select(Id,date,value) %>% 
  arrange(Id,date) %>% 
  mutate(date = mdy_hms(date))
bed %>% 
  mutate(SleepDay = mdy_hms(SleepDay))
heartrate <- list(heart1, heart2) %>% 
  reduce(full_join) %>% 
  select(Time,Id,Value) %>% 
  arrange(Id,Time) %>% 
  mutate(Time = mdy_hms(Time))
```

All files were loaded into RStudio, merged, and checked for readability, errors, missing data, NULLS, etc:

* Dates were standard formats but as character strings, changed to date objects.

* Numbers validated to be numbers only: integers or floats as appropriate to each column, with no text strings.

* Total daily activity time (SedentaryMinutes et al.) was checked to not be greater than 1440 minutes (24 hours).

```{r Validation, message=FALSE, warning=FALSE, results='hide'}
# check for NULL/missing data or zeros
any(is.na(totals)) # FALSE
any(is.na(weights)) # TRUE
any(is.na(sleeping)) # FALSE

totals %>% count(TotalSteps == 0) # 138 zeros
totals %>% count(Calories == 0) # 9 zeros

# misc. validations, no strange outliers
totals %>% 
  count(VeryActiveMinutes + 
          FairlyActiveMinutes + 
          LightlyActiveMinutes + 
          SedentaryMinutes > 1440) # 1440/60 = 24. There is only 24 hours in a day after all.
totals %>% 
  summarize(TotalSteps, TotalDistance) %>% 
  summary() # How many steps did people walk and how far?

weights %>% 
  summarise(WeightPounds) %>% 
  summary() # The scale is always honest.
weights %>% 
  summarise(Fat) %>% 
  range(na.rm=TRUE) # Suppresses NA values...
weights %>% 
  summarise(BMI) %>% 
  summary() # ...presumably, people don't track or advertise their BMI or body fat %.

sleeping %>% 
  summarize(value) %>% 
  summary() # assumed to be sleep stages or intensity

heartrate %>% 
  summarize(Value) %>% 
  summary() # huge heart rate range
```


## Analysis

### What are some trends in smart device usage?

While the idea of 10,000 daily steps is not based on any scientific merit, moderate exercise of 150 minutes a week as recommended by the CDC can be covered with sufficient walking at a reasonable pace.

```{r Summaries}
totals %>% 
  select(TotalSteps, TotalDistance, SedentaryMinutes) %>% 
  summary()
bed %>% 
  select(TotalMinutesAsleep, TotalTimeInBed) %>% 
  summary()
heartrate %>% 
  select(Value) %>% 
  summary()
```

The average distance participants walked or ran in a day was 5.2 miles and 7000 steps, above average for American adults but lower than other countries in Europe and equal to Japan^1^ ^2^. Data suggests American Fitbit users are **more active than average** and are meeting the health recommendations by the CDC, suggesting **health consciousness**.

Sleep times show a mean of 420 minutes or 7 hours of sleep. Regardless of time in bed most participants spend an extra 30-40 minutes in bed before falling asleep. While 7 hours is sufficient sleep, **75% of the adults in this study do not get the recommended 8+ hours of sleep.**^3^

Heart rates were considered average.^3^

```{r Heat Rates}
# heart rate patterns
heart_pattern <- heartrate %>% 
  ggplot(mapping=aes(x=Time,
                     y=Value)) +
  td

heart_pattern + geom_bin2d(show.legend=FALSE) +
  scale_fill_gradient(low="darkblue",high="orange") +
  labs(title="Heart Rate",
       subtitle="How fast was everyones heart beating?",
       x="Date",
       y="Heart Rates")
```

Outliers are present, but for the purposes of analysis do not affect conclusions.

#### Time Between Charges

Decided on a graph showing usage time to get an overview of device usage and battery life.

When Fitbit users were wearing the device, approximately half of the time it was worn at least 24 hours:    
```{r Wear Time}
power_minutes <- 
  totals$VeryActiveMinutes + 
  totals$FairlyActiveMinutes + 
  totals$LightlyActiveMinutes + 
  totals$SedentaryMinutes

# how often the Fitbit was powered on all day
totals %>% 
  count(power_minutes == 1440)
```

Plotted times between charges:

```{r Time Between Charges}
# battery times
power <- totals %>% ggplot() + theme_test()

power + 
  geom_histogram(mapping=aes(x=power_minutes/60),
                 binwidth=2,
                 color="white",
                 fill="green"
                 ) + 
  labs(title="Daily Fitbit Power", 
       subtitle="How often and how long between charges?",
       x="Hours",
       y="# of Charges"
       ) +
  tg
```

Assuming users removed and charged the Fitbit when it ran out of battery, the battery lasts well over 24 hours and averaged a use of 20 hours.

All-day use includes sleep, and the next step was analyzing sleep times and patterns.

#### Sleep Patterns
Per previous observations, average sleep time was 7 hours. Sleep patterns for 24 observed users was plotted on a heat map to show minutes of sleep time.

```{r Sleep Time and Quality}
# sleep patterns
sleep_pattern <- sleeping %>% ggplot(mapping=aes(x=date,
                                                 y=as.character(Id))) +
  theme_classic(base_size=15) +
  theme(axis.text.y=element_blank())

sleep_pattern + geom_bin2d() +
  scale_fill_gradient(low="darkblue",
                   high="orange",
                   guide="legend") +
  labs(title="Sleep Quality",
       subtitle="(or lack of)",
       x="Date",
       y="Participants",
       fill = "Minutes",
       )
```

Overall sleep quality is sufficient but not ideal, as indicated by summary data and heat map. The majority of participants are less than 8 hours of sleep, with several getting no more than 2-3 hours of sleep on the nights the Fitbit was worn.

### How could these trends apply to Bellabeat customers?
Given the data presented, Bellabeat customers can be expected to have similar exercise and sleep habits of:

* above average health awareness, and

* sufficient but not recommended amounts of sleep.


### How could these trends help influence Bellabeat marketing strategy?
Software such as a phone app can focus on womens health by:

* tracking and recommending sleep pattern changes, and

* tracking and encouraging walking for health and well-being.

These apps can be advertised as a means of attaining a healthy body and mind and giving stress relief, and giving women the power of knowing their bodies and selves better.

## Assumptions, Biases, and Variations

As with all data, extrapolations must be made from incomplete data sets. Extrapolation must be paired with the disclosure of what is hard facts and what is educated guesswork.

### Data is not considered exhaustive.

Data shows some zero activity and missing data for some days. The assumption is:

* users either did not power, charge, or wear the Fitbit on missing days, and

* days with logs but zero activity are days the user did not wear the Fitbit.

Times are assumed to be in the same time zone, although time zones are not relevant for analysis.

Distance measurements are not given and are assumed to be in miles. The "value" column in the sleep data is a range of 1-3, unknown what the value entails.

More comprehensive data is recommended for a better analysis of the task at hand, preferably tracking only women to match the demographics of Bellabeat.

### Sex of users is unknown.  
While assumptions can be made whether users are male or female based off of weight, BMI, and body fat percentage, they cannot be confirmed. User 1503960366 could be female as they are 117 pounds and 22% body fat, but ultimately unknown. Data collection would need to be done on a woman-only group to supply  analytics more relevant to Bellabeat.

### There are expected variations between different users.

From the Zenodo website:

> Variation between output represents use of different types of Fitbit trackers and individual tracking behaviors / preferences.  

Although the data set was from 30 volunteers there are 35 unique IDs, showing multiple devices between some users. Distinction between users and devices are not present, and not all participants logged sleep data:

```{r Distinct IDs, message=FALSE, warning=FALSE}
n_distinct(totals$Id)
n_distinct(sleeping$Id)
```

While overall users were average or above average in some ways there are a few exceptional individuals present. While they are outliers, they are considered with the same weight as other participants given the business task at hand.


## Conclusions

Data is limited in scope, but recommendations are to apply insights here to market further to existing customers and bring in new customers by focusing on a specific niche market of women; which niche is best left to marketing experts, but data suggests those who are seeking to improve their health and sleep.

## Citations

^1^ https://www.worldhealth.net/news/average-american-daily-walking-distance/

^2^ https://journals.lww.com/acsm-msse/Fulltext/2010/10000/Pedometer_Measured_Physical_Activity_and_Health.4.aspx

^3^ https://www.cdc.gov/sleep/about_sleep/how_much_sleep.html

> Further reading from CDC website: Watson NF, Badr MS, Belenky G, et al. Recommended amount of sleep for a healthy adult: a joint consensus statement of the American Academy of Sleep Medicine and Sleep Research Society. Sleep. 2015;38(6):843–844. 

^4^ https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6592896/

>...study provides the largest real-world norms for remotely obtained, real-world HR...